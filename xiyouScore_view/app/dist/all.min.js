!function(){function e(e){this.url=e.url,this.method=void 0===e.method.toLowerCase()?"GET":e.method.toUpperCase(),this.dataType=void 0===e.dataType?"XML":e.dataType.toUpperCase(),this.data=void 0===e.data?"":e.data,this.async=void 0===e.async||e.async,this.success=e.success,this.error=e.error,this.xml=null,this.init()}e.prototype={constructor:e,init:function(){this.create()},create:function(){window.XMLHttpRequest?this.xml=new XMLHttpRequest:this.xml=new ActiveXObject("Microsoft.XMLHTTP"),this.stringfy(),"JSON"===this.dataType?this.getJson():"JSONP"===this.dataType&&this.getJsonp()},stringfy:function(){var e="";if("object"==typeof this.data){for(var t in this.data)e+="&"+t+"="+this.data[t];e=e.substring(1)}this.data=e},getJson:function(){this.url=this.url+"?rand="+Math.random();var e=function(){200==this.xml?this.success(this.xml.responseText):this.error(this.xml.status)};this.async&&(this.xml.onreadystatechange=function(){4==this.xml.readyState&&e()}),this.xml.open(this.method,this.url,this.async),"GET"==this.method?(this.url=this.url+"&"+this.data,this.xml.send(null)):(this.xml.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xml.send(this.data)),this.xml.async||e()},getJsonp:function(){var e=document.querySelector("head"),t=this,o=document.createElement("script");o.type="text/javascript";var n="callback"+(new Date).getTime();o.src=this.url+"?"+this.data+"&callback="+n,e.appendChild(o),window[n]=function(n){t.success(n),e.removeChild(o)}}},window.Ajax=e}(),function(){function e(){var e=document.querySelector(".year").innerHTML,t=document.querySelector(".month").innerHTML;"选择学年"!==e?"选择学期"!==t?new Ajax({method:"post",url:"http://localhost:3004/users/classes",dataType:"jsonp",data:{username:window.localStorage.username,name:window.localStorage.name,session:window.localStorage.session,check:!0,year:e,month:t},success:function(e){e.error&&new Popup({status:"error",message:"查询失败",promp:"请刷新试试~"});var t=document.querySelector(".class-content");t&&t.parentNode.removeChild(t);var o=["一","二","三","四","五"],n=document.createElement("div"),s=e.result;n.className="class-content";for(var a='<div class="box-left"><div class="box-space"></div>',r=0;r<5;r++)a+='<div class="box-date">星<br />期<br />'+o[r]+"</div>";a+='</div><div class="box-right"><div class="box-top"><span>上午</span><span>下午</span></div>';for(r=0;r<s.length;r++){var c=s[r].classes;a+='<div class="date-detail">';for(var i=0;i<c.length;i++)void 0!==c[i].classRoom?a+="<span>教室<br />"+c[i].classRoom+"<br /><br />课程<br />"+c[i].className+"<br /><br />教师<br />"+c[i].teacherName+"</span>":a+="<span></span>";a+="</div>"}n.innerHTML=a,document.querySelector(".class-wrapper").appendChild(n)}}):new Popup({status:"warning",message:"查询失败",promp:"请选择学期~"}):new Popup({status:"warning",message:"查询失败",promp:"请选择学年~"})}new Ajax({method:"post",url:"http://172.20.0.69:3004/users/classes",dataType:"jsonp",data:{username:window.localStorage.username,name:window.localStorage.name,session:window.localStorage.session,check:!1},success:function(t){if(t.error)new Popup({status:"warning",message:"查询失败",promp:"请重新试试~"});else{var o=t.result.year,n=t.result.month,s=document.querySelector(".toCheck");document.querySelector(".year").addEventListener("click",function(){new Select({show:o,dom:document.querySelector(".year")})},!1),document.querySelector(".month").addEventListener("click",function(){new Select({show:n,dom:document.querySelector(".month")})},!1),s.addEventListener("click",e,!1)}},error:function(e){console.log(e)}}),document.querySelector(".back").addEventListener("click",function(){window.location.href="../html/index.html"})}(),function(){new Ajax({url:"http://172.20.0.69:3004/score/grade",method:"post",dataType:"jsonp",data:{name:window.localStorage.name,username:window.localStorage.username,session:window.localStorage.session},success:function(e){if(e.error)new Popup({status:"warning",message:"加载失败",promp:"请刷新试试~"});else{var t=e.result;console.log(t[0]);for(var o=document.createDocumentFragment(),n=0;n<t.length;n++){var s=document.createElement("div");s.className="grade-box",s.innerHTML="<p><span>学年："+t[n]["学年"]+"</span><span>学期："+t[n]["学期"]+"</span></p><p>课程名称："+t[n]["课程名称"]+"</p><p><span>课程性质："+t[n]["课程性质"]+"</span><span>学分："+t[n]["学分"]+"</span></p><p>开课学院："+t[n]["开课学院"]+"</p><p><span>成绩："+t[n]["成绩"]+"</span><span>绩点："+t[n]["绩点"]+"</span></p><p><span>补考成绩："+t[n]["补考成绩"]+"</span><span>重修成绩："+t[n]["重修成绩"]+"</span></p>",o.appendChild(s)}document.querySelector(".grade-wrapper").appendChild(o)}}}),document.querySelector(".back").addEventListener("click",function(){window.location.href="../html/index.html"})}(),function(){window.localStorage.name||(window.location.href="../html/login.html");var e=document.querySelector(".index-wrapper"),t=document.querySelector(".exit");e.addEventListener("click",function(e){switch((e||window.event).target.id){case"person":window.location.href="../html/info.html";break;case"grade":window.location.href="../html/grade.html";break;case"class":window.location.href="../html/class.html"}}),t.addEventListener("click",function(){console.log("ok"),window.localStorage.name="",window.localStorage.username="",window.localStorage.session="",window.location.href="../html/login.html"})}(),function(){function e(e){return document.querySelector("#"+e)}new Ajax({url:"http://172.20.0.69:3004/users/info",method:"post",dataType:"jsonp",data:{name:window.localStorage.name,username:window.localStorage.username,session:window.localStorage.session},success:function(t){if(t.error)new Popup({status:"error",message:"获取失败",promp:"请重新登录~",callback:function(){window.location.href="../../html/login.html"}});else for(var o in t.result)e(o).innerHTML=t.result[o]}}),document.querySelector(".back").addEventListener("click",function(){window.location.href="../html/index.html"})}(),function(){function e(){new Ajax({url:"http://172.20.0.69:3004/users/verCode",method:"get",dataType:"jsonp",success:function(e){e.error?new Popup({status:"error",message:"验证码请求错误，请点击图片刷新一下~",promp:"我知道了"}):(console.log(e.result.verCode),t.src=e.result.verCode,window.localStorage.session=e.result.session)}})}var t=document.querySelector(".img");document.querySelector(".login-btn").addEventListener("click",function(){var e=document.querySelector("#username").value,t=document.querySelector("#password").value,o=document.querySelector("#verCode").value;""!==e?""!==t?""!==o?(window.localStorage.username=document.querySelector("#username").value+"",new Ajax({method:"post",url:"http://172.20.0.69:3004/users/login",dataType:"jsonp",data:{username:document.querySelector("#username").value+"",password:document.querySelector("#password").value,verCode:document.querySelector("#verCode").value,session:window.localStorage.session},success:function(e){e.error?new Popup({status:"error",message:e.result,promp:"我知道了"}):(window.localStorage.name=e.result,console.log("ok"),new Popup({status:"success",message:"登陆成功！",promp:"我知道了",callback:function(){window.location.href="../html/index.html"}}))},error:function(e){console.log(e)}})):new Popup({status:"error",message:"请输入验证码",promp:"我知道了"}):new Popup({status:"error",message:"请输入密码",promp:"我知道了"}):new Popup({status:"error",message:"请输入用户名",promp:"我知道了"})}),t.addEventListener("click",e),window.onload=function(){e()}}();